<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>View tasks</title>
</head>
<body>
<h1>Du er i task</h1>
<a th:href="@{/projects/{projectId}/subprojects/{subprojectId}/tasks/new(
                    projectId=${project.id}, subprojectId=${subproject.id})}">Opret ny opgave</a>
<table>
    <tr>
        <th>Opgave</th>
        <th>Status</th>
        <th>Beskrivelse</th>
        <th>Tids allokering</th>
        <th>Brugt tid</th>
        <th>Deadline</th>
        <th>Tildelt</th>
        <th>Prioritet</th>
        <th>Opdater</th>
        <th>Slet</th>
    </tr>
    <tr th:each="task : ${tasks}">
        <td th:text="${task.name}"></td>
        <td th:text="${task.completed}"></td>
        <td th:text="${task.description}"></td>
        <td th:text="${task.timeBudget}"></td>
        <td th:text="${task.timeTaken}"></td>
        <td th:text="${#temporals.format(task.deadline, 'dd-MM-yyyy')}"></td>
        <td>
        <span th:each="user, iterStat : ${task.users}">
            <span th:text="${user.name}"></span>
            <!-- Places a comma if not last -->
            <span th:if="${!iterStat.last}">, </span>
        </span>
        </td>
        <td th:text="${task.priorityLevel != null ? task.priorityLevel.displayName : ''}"></td>
        <td><a th:href="@{/projects/{projectId}/subprojects/{subprojectId}/tasks/{taskId}/task(
                    projectId=${project.id}, subprojectId=${subproject.id}, taskId=${task.id})}">
            Opdater
        </a></td>
        <td>
            <form th:action="@{/projects/{projectId}/subprojects/{subprojectId}/tasks/{taskId}/delete(
                    projectId=${project.id}, subprojectId=${subproject.id}, taskId=${task.id})}" method="post"
                  onsubmit="return confirm('Er du sikker pÃ¥, at du vil slette denne opgave?');">
                <button type="submit">Slet</button>
            </form>
        </td>
    </tr>
</table>
</body>
</html>